<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../css/hakyll-cssgarden/bronx.css">
    <link rel="stylesheet" href="../css/syntax.css">
    <link rel="stylesheet" href="../css/custom.css">
    <title>My Hakyll Blog - nodenvを用いたNode.js環境のセットアップ</title>
  </head>
  <body>
    <div id="header">
      <div id="logo">
        <a href="../">Nobiruwa's</a>
      </div>
      <div id="navigation">
        <a href="../">Home</a>
        <a href="../archive.html">Archive</a>
      </div>
    </div>

    <div id="content">
      <h1>nodenvを用いたNode.js環境のセットアップ</h1>

      <div class="info">
    Posted on March 21, 2022
    
        by nobiruwa
    
</div>

<h2 id="tldr">tl;dr</h2>
<pre class="console"><code>$ git clone https://github.com/nodenv/nodenv.git $HOME/.nodenv
$ NODENV_HOME=&quot;$HOME/.nodenv&quot;
$ NODENV_BIN=&quot;$NODENV_HOME/bin&quot;
$ PATH=&quot;$NODENV_BIN:$PATH&quot;
$ eval &quot;$(nodenv init -)&quot;
$ mkdir -p $(nodenv root)/plugins
$ git clone https://github.com/nodenv/node-build.git &quot;$(nodenv root)&quot;/plugins/node-build
$ cat &lt;&lt; EOF &gt;&gt; ~/.profile
NODENV_HOME=&quot;$HOME/.nodenv&quot;
NODENV_BIN=&quot;$NODENV_HOME/bin&quot;
if [ -d &quot;$NODENV_BIN&quot; ]; then
    export PATH=&quot;$NODENV_BIN:$PATH&quot;
    # rehash after init, because my login shell is dash.
    eval &quot;$(nodenv init --no-rehash -)&quot;
    (nodenv rehash &amp;) 2&gt; /dev/null
fi
EOF</code></pre>
<h2 id="動機">動機</h2>
<p><a href="2019-06-16-setup-java-environment-with-jenv.html">jEnvを用いたJava環境のセットアップ</a>と同じく、プログラミング言語の開発環境を<a href="https://github.com/rbenv/rbenv">rbenv/rbenv</a>のフォークである<a href="https://github.com/nodenv/nodenv">nodenv/nodenv</a>によって構築したいと思いました。</p>
<h2 id="セットアップ">セットアップ</h2>
<h3 id="nodenvのチェックアウト">nodenvのチェックアウト</h3>
<p><code>nodenv</code>リポジトリをチェックアウトします。</p>
<p>場所は公式に合わせて<code>~/.nodenv</code>とします。</p>
<p>さらに、<code>node-build</code>リポジトリをnodenvのプラグインとしてチェックアウトします。</p>
<pre class="console"><code>$ git clone https://github.com/nodenv/nodenv.git $HOME/.nodenv
# 一時的に`$HOME/.nodenv/bin`を`$PATH`に追加してnode-buildをインストールする
$ NODENV_HOME=&quot;$HOME/.nodenv&quot;
$ NODENV_BIN=&quot;$NODENV_HOME/bin&quot;
$ PATH=&quot;$NODENV_BIN:$PATH&quot;
$ eval &quot;$(nodenv init -)&quot;
$ mkdir -p $(nodenv root)/plugins
$ git clone https://github.com/nodenv/node-build.git &quot;$(nodenv root)&quot;/plugins/node-build</code></pre>
<h3 id="profileの記述"><code>~/.profile</code>の記述</h3>
<p><code>~/.profile</code>にて、環境変数<code>PATH</code>を設定します。</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="va">NODENV_HOME</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$HOME</span><span class="st">/.nodenv&quot;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="va">NODENV_BIN</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$NODENV_HOME</span><span class="st">/bin&quot;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">-d</span> <span class="st">&quot;</span><span class="va">$NODENV_BIN</span><span class="st">&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">export</span> <span class="va">PATH</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$NODENV_BIN</span><span class="st">:</span><span class="va">$PATH</span><span class="st">&quot;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rehash after init, because my login shell is dash.</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">eval</span> <span class="st">&quot;</span><span class="va">$(</span><span class="ex">nodenv</span> init <span class="at">--no-rehash</span> <span class="at">-</span><span class="va">)</span><span class="st">&quot;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">(</span><span class="ex">nodenv</span> rehash <span class="kw">&amp;)</span> <span class="dv">2</span><span class="op">&gt;</span> /dev/null</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span></code></pre></div>
<h2 id="node.jsのインストール">Node.jsのインストール</h2>
<p><code>nodenv install</code>コマンドで<code>~/.nodenv/versions</code>配下に特定のバージョンのNode.jsをインストールします。</p>
<pre class="console"><code># インストール可能なバージョンを列挙する
$ nodenv install --list
# 16.14.2をインストールする場合
$ nodenv install 16.14.2</code></pre>
<p>登録されたNode.jsは下記のコマンドで確認できます。</p>
<pre class="console"><code>$ nodenv versions</code></pre>
<p>なお、<code>npm i -g</code>コマンドは<code>~/.nodenv/versions/&lt;nodenv versionsで列挙されるバージョン文字列&gt;</code>ディレクトリ配下にインストールされます。</p>
<p>これだけではコマンドを使用可能になりませんので、<code>nodenv rehash</code>コマンドを実行してください。</p>
<p>すべてのバージョンの<code>bin</code>ディレクトリを更新するので少々時間がかかります。</p>
<h2 id="グローバルのnode.js環境">グローバルのNode.js環境</h2>
<p>グローバルのNode.js環境を指定します。</p>
<pre class="console"><code>$ nodenv global &lt;nodenv versionsで列挙されるバージョン文字列&gt;</code></pre>
<h2 id="ローカルのnode.js環境">ローカルのNode.js環境</h2>
<p>ローカルのNode.js環境を設定するには、以下のコマンドを実行します。</p>
<pre class="console"><code>$ cd &lt;設定したいディレクトリ&gt;
$ nodenv local &lt;nodenv versionsで列挙されるバージョン文字列&gt;</code></pre>
<p><code>nodenv local</code>を実行したディレクトリには<code>.node-version</code>ファイルが生成されます。</p>
<p><code>nodenv local</code>を実行したディレクトリとその子孫ディレクトリで実行する<code>node</code>/<code>npm</code>コマンド等は、<code>.node-version</code>で指定されたNode.js環境のものが使用されます。</p>

    </div>
    <div id="footer">
      Site proudly generated by
      <a href="http://jaspervdj.be/hakyll">Hakyll</a>
    </div>
  </body>
</html>
